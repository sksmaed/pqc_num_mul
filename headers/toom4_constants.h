# ifndef TOOM_CONSTANTS_H
# define TOOM_CONSTANTS_H

#include <stdio.h>
#include <inttypes.h>

#define P 18446744069414584321ULL
#define P32 ((uint32_t)(P))
#define R ((__uint128_t)1 << 128)
#define BARRETT_V ((R) / P)

#define LIMB_PER_PART 96
#define TOTAL_LIMBS   384
#define NUM_PARTS     4
#define NUM_EVALS     7
#define RESULT_LIMBS  768
#define PROD_LIMBS    (2 * LIMB_PER_PART)
#define LIMB_SIZE     16
#define BASE          (1 << LIMB_SIZE)
#define HALF          48
#define QUARTER       24

const int16_t x_powers[7][7] = {
    {1, -2, 4, -8, 16, -32, 64},
    {1, -1, 1, -1, 1, -1, 1},
    {1, 0, 0, 0, 0, 0, 0},
    {1, 1, 1, 1, 1, 1, 1},
    {1, 2, 4, 8, 16, 32, 64},
    {1, 4, 16, 64, 256, 1024, 4096},
    {0, 0, 0, 0, 0, 0, 1}
};

static const uint64_t inv_mat[7][7] = {
    { 0, 0, 1, 0, 0, 0, 0 },
    { 11273010264642245974ULL, 9838263503687778304ULL, 4611686017353646080ULL, 14347467609544676695ULL, 3074457344902430720ULL, 12195347468112975190ULL, 18446744069414584305ULL},
    { 768614336225607680ULL, 6148914689804861441ULL, 4611686017353646079ULL, 6148914689804861441ULL, 768614336225607680UL, 0, 4 },
    { 13194546105206265174ULL, 0, 12682136547722526721ULL, 2049638229934953813ULL, 14987979556399349761ULL, 12425931768980657494ULL, 20 },
    { 17678129733188976641ULL, 3074457344902430720ULL, 13835058052060938241ULL, 3074457344902430720ULL, 17678129733188976641ULL, 0, 18446744069414584316ULL},
    { 12425931768980657494ULL, 17831852600434098177ULL, 1152921504338411520ULL, 11273010264642245974ULL, 384307168112803840ULL, 12272208901735535958ULL, 18446744069414584317ULL},
    { 0, 0, 0, 0, 0, 0, 1 },
};

#endif // TOOM_CONSTANTS_H